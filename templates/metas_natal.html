<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Meta Di√°ria - Natal Logcomex</title>
    <link rel="icon" type="image/x-icon" href="/static/img/favicon.ico">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#6613D0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Natal Logcomex">
    <link rel="manifest" href="/static/manifest.json">
    <link rel="apple-touch-icon" href="/static/img/icon-192.png">
    
    <link rel="stylesheet" href="/static/css/metas.css">
    <link rel="stylesheet" href="/static/css/deal_celebration.css">
    <link rel="stylesheet" href="/static/css/deal_celebration_themes.css">
    <link rel="stylesheet" href="/static/css/home-button.css">
</head>
<body>
    <a href="/" class="home-button" title="Voltar para p√°gina inicial">üè†</a>
    <img src="/static/img/confidencial.png" alt="Confidencial" class="confidencial-logo">
    <img src="/static/img/bruno_megafone.png" alt="Bruno Megafone" class="bruno-megafone-image">
    
    <!-- Componente Universal de Celebra√ß√£o -->
    {% include 'includes/celebration_component.html' %}
    
    <!-- Container Principal -->
    <div class="container">
        <img src="/static/img/blck_november.png" alt="Black November Logcomex" class="black-november-logo">
        <img src="/static/img/%23facanacaveira.png" alt="Faca na Caveira" class="skull-sword-image">
        <img src="/static/img/faixa_laranja.png" alt="Faixa Laranja" class="orange-band-image">
        <img src="/static/img/feixa_roxa.png" alt="Faixa Roxa" class="purple-band-image">
        
        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <div>Carregando metas...</div>
        </div>
        
        <!-- Conte√∫do Principal -->
        <div class="metas-content" id="metasContent" style="display: none;">
            <!-- T√≠tulo da Meta do Dia -->
            <div class="meta-header">
                <h1 class="meta-title">üéØ META DO DIA</h1>
                <div class="meta-value-display" id="metaDoDia">R$ 0</div>
            </div>
            
            <!-- Barra de Progresso Gigante -->
            <div class="progress-section">
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progressBar"></div>
                    <div class="progress-percentage" id="progressPercentage">0%</div>
                </div>
                <div class="progress-info">
                    <div class="progress-current">
                        <span class="label">üí∞ Atual:</span>
                        <span class="value" id="valorAtual">R$ 0</span>
                    </div>
                    <div class="progress-missing">
                        <span class="label">üìä Faltam:</span>
                        <span class="value" id="valorFaltante">R$ 0</span>
                    </div>
                    <div class="progress-pipeline">
                        <span class="label">üé≤ Pipeline Previsto:</span>
                        <span class="value" id="valorPipeline">R$ 0</span>
                        <span class="deals-count" id="dealsCount">(0 deals)</span>
                    </div>
                </div>
            </div>
            
            <!-- Linha: Rel√≥gio + Ritmo Atual + Status -->
            <div class="combined-section">
                <!-- Contagem Regressiva -->
                <div class="countdown-box">
                    <div class="countdown-icon">‚è±Ô∏è</div>
                    <div class="countdown-text">Tempo restante:</div>
                    <div class="countdown-timer" id="countdown">18:00:00</div>
                </div>
                
                <!-- Ritmo Atual -->
                <div class="rhythm-box">
                    <h3 class="box-title">üìà RITMO ATUAL</h3>
                    <div class="rhythm-mini-grid">
                        <div class="rhythm-mini-card">
                            <div class="rhythm-label">M√©dia/hora</div>
                            <div class="rhythm-value" id="mediaPorHora">R$ 0</div>
                        </div>
                        <div class="rhythm-mini-card">
                            <div class="rhythm-label">Proje√ß√£o dia</div>
                            <div class="rhythm-value" id="projecaoFimDia">R$ 0</div>
                        </div>
                    </div>
                </div>
                
                <!-- Status -->
                <div class="status-box" id="statusCard">
                    <div class="status-icon">üéØ</div>
                    <div class="status-label">STATUS</div>
                    <div class="status-text" id="statusText">Calculando...</div>
                </div>
            </div>
            
            <!-- Divisor -->
            <div class="section-divider"></div>
            
            <!-- Estat√≠sticas do M√™s -->
            <div class="month-stats-section">
                <h2 class="section-title">üéÑ NATAL LOGCOMEX 2025</h2>
                <div class="month-stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <div class="stat-label">Faturado no m√™s</div>
                            <div class="stat-value" id="faturadoMes">R$ 0</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-content">
                            <div class="stat-label">Meta do m√™s</div>
                            <div class="stat-value" id="metaMes">R$ 1.500.000</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-content">
                            <div class="stat-label">Falta atingir</div>
                            <div class="stat-value" id="faltaMes">R$ 0</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìÜ</div>
                        <div class="stat-content">
                            <div class="stat-label">Dias √∫teis restantes</div>
                            <div class="stat-value" id="diasUteis">0 dias</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/javascript/metas.js"></script>
    <script src="/static/javascript/celebration_theme_manager.js"></script>
    <script src="/static/javascript/deal_celebration.js"></script>
    
    <!-- Sistema de Rota√ß√£o Autom√°tica -->
    <script>
        // Verifica se est√° no modo de rota√ß√£o autom√°tica
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('aleatorio')) {
            // Tenta desbloquear √°udio automaticamente no modo aleat√≥rio
            window.addEventListener('load', () => {
                const audio = document.getElementById('cornetAudio');
                if (audio) {
                    audio.volume = 0.01; // Volume muito baixo
                    const playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            audio.pause();
                            audio.currentTime = 0;
                            audio.volume = 1.0; // Restaura volume
                            console.log('‚úÖ √Åudio desbloqueado automaticamente');
                        }).catch(err => {
                            console.log('‚ö†Ô∏è √Åudio n√£o desbloqueado automaticamente (normal)');
                        });
                    }
                }
            });
            
            // NOTA: O timer de navega√ß√£o agora √© iniciado pelo JavaScript (metas.js)
            // ap√≥s os dados carregarem, garantindo que o tempo s√≥ comece a contar depois
            // que os dados estiverem prontos.
        }
    </script>
</body>
</html>
